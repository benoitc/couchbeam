<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.2">
    <meta name="project" content="couchbeam v2.0.0">


    <title>Readme â€” couchbeam v2.0.0</title>

    <link rel="stylesheet" href="dist/html-erlang-DQDXQC7W.css" />

    <script defer src="dist/sidebar_items-A03F7C15.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

      <div>
        <a href="readme.html" class="sidebar-projectName" translate="no">
couchbeam
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v2.0.0
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of couchbeam</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>Couchbeam - simple Apache CouchDB client library for Erlang applications</h1>


      <a href="https://github.com/benoitc/couchbeam/blob/v2.0.0/README.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<p>Copyright (c) 2009-2025 Benoit Chesneau.</p><p><strong>Version:</strong> 1.7.1</p><h1>couchbeam</h1><p>Couchbeam is a simple erlang library for <a href="https://barrel-db.org">Barrel</a> or <a href="http://couchdb.apache.org">Apache CouchDB</a>. Couchbeam provides you a full featured and easy client to access and manage multiple nodes.</p><h4>Main features:</h4><ul><li>Complete support of the BarrelDB and Apache CouchDB API</li><li>Stream view results to your app</li><li>Stream changes feeds</li><li>reduced memory usage</li><li>fetch and send attachments in a streaming fashion</li><li>JSON encoding/decoding via Erlang/OTP stdlib <code class="inline">json</code> with maps</li></ul><h4>Useful modules are:</h4><ul><li><a href="http://github.com/benoitc/couchbeam/blob/master/doc/couchbeam.md"><code class="inline">couchbeam</code></a>: The <code class="inline">couchbeam</code> module is the main interface for interaction with this application. It includes functions for managing connections to Apache CouchDB or RCOUCH servers and databases and for performing document creations, updates, deletes, views...</li><li><a href="http://github.com/benoitc/couchbeam/blob/master/doc/couchbeam_doc.md"><code class="inline">couchbeam_doc</code></a> Module to manipulate Documents structures. You can set values,
updates keys, ...</li><li><a href="http://github.com/benoitc/couchbeam/blob/master/doc/couchbeam_attachments.md"><code class="inline">couchbeam_attachments</code></a>: Module to manipulate attachments. You can add, remove
attachments in a Document structure (inline attachments).</li><li><a href="http://github.com/benoitc/couchbeam/blob/master/doc/couchbeam_view.md"><code class="inline">couchbeam_view</code></a>: Module to manage view results.</li><li><a href="http://github.com/benoitc/couchbeam/blob/master/doc/couchbeam_changes.md"><code class="inline">couchbeam_changes</code></a>: Module to manage changes feeds. Follow continuously
the changes in a db or get all changes at once.</li></ul><p>The goal of Couchbeam is to ease the access to the Apache CouchDB and RCOUCH HTTP API in erlang.</p><p>Read the <a href="https://raw.github.com/benoitc/couchbeam/master/NEWS">NEWS</a> file
to get last changelog.</p><h2 id="installation" class="section-heading"><a href="#installation" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Installation</span></h2><p>Download the sources from our <a href="http://github.com/benoitc/couchbeam">Github repository</a></p><p>To build the application simply run 'make'. This should build .beam, .app
files and documentation.</p><p>To run tests run 'make test'.
To generate doc, run 'make doc'.</p><p>Or add it to your rebar config</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="p" data-group-id="6445689770-1">{</span><span class="ss">deps</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6445689770-2">[</span><span class="w">
    </span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="w">
    </span><span class="p" data-group-id="6445689770-3">{</span><span class="ss">couchbeam</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;.*&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6445689770-4">{</span><span class="ss">git</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;git://github.com/benoitc/couchbeam.git&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6445689770-5">{</span><span class="ss">branch</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;master&quot;</span><span class="p" data-group-id="6445689770-5">}</span><span class="p" data-group-id="6445689770-4">}</span><span class="p" data-group-id="6445689770-3">}</span><span class="w">
</span><span class="p" data-group-id="6445689770-2">]</span><span class="p" data-group-id="6445689770-1">}</span><span class="p">.</span></code></pre><p>Note to compile with jiffy you need to define in the erlang options the
variable <code class="inline">WITH_JIFFY</code>.</p><p>if you use rebar, add to your <code class="inline">rebar.config</code>:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="p" data-group-id="1769201874-1">{</span><span class="ss">erl_opts</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1769201874-2">[</span><span class="p" data-group-id="1769201874-3">{</span><span class="ss">d</span><span class="p">,</span><span class="w"> </span><span class="ss">&#39;WITH_JIFFY&#39;</span><span class="p" data-group-id="1769201874-3">}</span><span class="p" data-group-id="1769201874-2">]</span><span class="p" data-group-id="1769201874-1">}</span><span class="p">.</span></code></pre><p>or use the <code class="inline">rebar</code> command with the <code class="inline">-D</code> options:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">sh</span><span class="w">
</span><span class="ss">rebar</span><span class="w"> </span><span class="ss">compile</span><span class="w"> </span><span class="o">-</span><span class="n">DWITH_JIFFY</span></code></pre><h2 id="basic-usage" class="section-heading"><a href="#basic-usage" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Basic Usage</span></h2><h3 id="start-couchbeam" class="section-heading"><a href="#start-couchbeam" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Start couchbeam</span></h3><p>Couchbeam is an <a href="http://www.erlang.org/doc/design_principles/users_guide.html">OTP</a>
application. You have to start it first before using any of the
functions. The couchbeam application will start the default socket pool
for you.</p><p>To start in the console run:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">sh</span><span class="w">
</span><span class="sc">$ </span><span class="ss">erl</span><span class="w"> </span><span class="o">-</span><span class="ss">pa</span><span class="w"> </span><span class="ss">ebin</span><span class="gp unselectable">
1&gt; </span><span class="nc">couchbeam</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="6819056444-1">(</span><span class="p" data-group-id="6819056444-1">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span></code></pre><p>It will start hackney and all of the application it depends on:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="nc">application</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="2163703700-1">(</span><span class="ss">crypto</span><span class="p" data-group-id="2163703700-1">)</span><span class="p">,</span><span class="w">
</span><span class="nc">application</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="2163703700-2">(</span><span class="ss">asn1</span><span class="p" data-group-id="2163703700-2">)</span><span class="p">,</span><span class="w">
</span><span class="nc">application</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="2163703700-3">(</span><span class="ss">public_key</span><span class="p" data-group-id="2163703700-3">)</span><span class="p">,</span><span class="w">
</span><span class="nc">application</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="2163703700-4">(</span><span class="ss">ssl</span><span class="p" data-group-id="2163703700-4">)</span><span class="p">,</span><span class="w">
</span><span class="nc">application</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="2163703700-5">(</span><span class="ss">hackney</span><span class="p" data-group-id="2163703700-5">)</span><span class="p">,</span><span class="w">
</span><span class="nc">application</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="2163703700-6">(</span><span class="ss">couchbeam</span><span class="p" data-group-id="2163703700-6">)</span><span class="p">.</span></code></pre><p>Or add couchbeam to the applications property of your .app in a release</p><h3 id="create-a-connection-to-the-server" class="section-heading"><a href="#create-a-connection-to-the-server" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Create a connection to the server</span></h3><p>To create a connection to a server machine:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="n">Url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;http://localhost:5984&quot;</span><span class="p">,</span><span class="w">
</span><span class="n">Options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="4972873888-1">[</span><span class="p" data-group-id="4972873888-1">]</span><span class="p">,</span><span class="w">
</span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam</span><span class="p">:</span><span class="nf">server_connection</span><span class="p" data-group-id="4972873888-2">(</span><span class="n">Url</span><span class="p">,</span><span class="w"> </span><span class="n">Options</span><span class="p" data-group-id="4972873888-2">)</span><span class="p">.</span></code></pre><p>Test the connection with <a href="couchbeam.html#server_info/1"><code class="inline">couchbeam:server_info/1</code></a> :</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="p" data-group-id="7485970398-1">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="n">Version</span><span class="p" data-group-id="7485970398-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam</span><span class="p">:</span><span class="nf">server_info</span><span class="p" data-group-id="7485970398-2">(</span><span class="n">S</span><span class="p" data-group-id="7485970398-2">)</span><span class="p">.</span></code></pre><h3 id="open-or-create-a-database" class="section-heading"><a href="#open-or-create-a-database" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Open or Create a database</span></h3><p>All document operations are done in databases. To open a database simply do:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="n">Options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="0614323818-1">[</span><span class="p" data-group-id="0614323818-1">]</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="0614323818-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Db</span><span class="p" data-group-id="0614323818-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam</span><span class="p">:</span><span class="nf">open_db</span><span class="p" data-group-id="0614323818-3">(</span><span class="n">Server</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;testdb&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Options</span><span class="p" data-group-id="0614323818-3">)</span><span class="p">.</span></code></pre><p>To create a new one:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="n">Options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="6920530037-1">[</span><span class="p" data-group-id="6920530037-1">]</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="6920530037-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Db</span><span class="p" data-group-id="6920530037-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam</span><span class="p">:</span><span class="nf">create_db</span><span class="p" data-group-id="6920530037-3">(</span><span class="n">Server</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;testdb&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Options</span><span class="p" data-group-id="6920530037-3">)</span><span class="p">.</span></code></pre><p>You can also use the shorcut <a href="couchbeam.html#open_or_create_db/3"><code class="inline">couchbeam:open_or_create_db/3</code></a>. that
will create a database if it does not exist.</p><h3 id="make-a-new-document" class="section-heading"><a href="#make-a-new-document" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Make a new document</span></h3><p>Make a new document:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="n">Doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="0233635703-1">#{</span><span class="w">
    </span><span class="p" data-group-id="0233635703-2">&lt;&lt;</span><span class="s">&quot;_id&quot;</span><span class="p" data-group-id="0233635703-2">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="0233635703-3">&lt;&lt;</span><span class="s">&quot;test&quot;</span><span class="p" data-group-id="0233635703-3">&gt;&gt;</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0233635703-4">&lt;&lt;</span><span class="s">&quot;content&quot;</span><span class="p" data-group-id="0233635703-4">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="0233635703-5">&lt;&lt;</span><span class="s">&quot;some text&quot;</span><span class="p" data-group-id="0233635703-5">&gt;&gt;</span><span class="w">
</span><span class="p" data-group-id="0233635703-1">}</span><span class="p">.</span></code></pre><p>And save it to the database:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="p" data-group-id="0076399227-1">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Doc1</span><span class="p" data-group-id="0076399227-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam</span><span class="p">:</span><span class="nf">save_doc</span><span class="p" data-group-id="0076399227-2">(</span><span class="n">Db</span><span class="p">,</span><span class="w"> </span><span class="n">Doc</span><span class="p" data-group-id="0076399227-2">)</span><span class="p">.</span></code></pre><p>The <a href="couchbeam.html#save_doc/2"><code class="inline">couchbeam:save_doc/2</code></a> return a new document with updated
revision and if you do not specify the _id, a unique document id.</p><p>To change an document property use functions from <code class="inline">couchbeam_doc</code>.</p><h3 id="retrieve-a-document" class="section-heading"><a href="#retrieve-a-document" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Retrieve a document</span></h3><p>To retrieve a document do:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="p" data-group-id="7358845646-1">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Doc2</span><span class="p" data-group-id="7358845646-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam</span><span class="p">:</span><span class="nf">open_doc</span><span class="p" data-group-id="7358845646-2">(</span><span class="n">Db</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;test&quot;</span><span class="p" data-group-id="7358845646-2">)</span><span class="p">.</span></code></pre><p>If you want a specific revision:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="n">Rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam_doc</span><span class="p">:</span><span class="nf">get_rev</span><span class="p" data-group-id="2872709009-1">(</span><span class="n">Doc1</span><span class="p" data-group-id="2872709009-1">)</span><span class="p">,</span><span class="w">
</span><span class="n">Options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="2872709009-2">[</span><span class="p" data-group-id="2872709009-3">{</span><span class="ss">rev</span><span class="p">,</span><span class="w"> </span><span class="n">Rev</span><span class="p" data-group-id="2872709009-3">}</span><span class="p" data-group-id="2872709009-2">]</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="2872709009-4">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Doc3</span><span class="p" data-group-id="2872709009-4">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam</span><span class="p">:</span><span class="nf">open_doc</span><span class="p" data-group-id="2872709009-5">(</span><span class="n">Db</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;test&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Options</span><span class="p" data-group-id="2872709009-5">)</span><span class="p">.</span></code></pre><p>Here we get the revision from the document we previously stored. Any
options from the Apache CouchDB and RCOUCH API can be used.</p><h3 id="get-all-documents" class="section-heading"><a href="#get-all-documents" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Get all documents</span></h3><p>To get all documents you have first to create an object
that will keep all informations.</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="n">Options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="6184836846-1">[</span><span class="ss">include_docs</span><span class="p" data-group-id="6184836846-1">]</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="6184836846-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">AllDocs</span><span class="p" data-group-id="6184836846-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam_view</span><span class="p">:</span><span class="nf">all</span><span class="p" data-group-id="6184836846-3">(</span><span class="n">Db</span><span class="p">,</span><span class="w"> </span><span class="n">Options</span><span class="p" data-group-id="6184836846-3">)</span><span class="p">.</span></code></pre><p>Example result (abridged):</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="p" data-group-id="0065679452-1">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0065679452-2">[</span><span class="w">
    </span><span class="p" data-group-id="0065679452-3">#{</span><span class="w">
      </span><span class="p" data-group-id="0065679452-4">&lt;&lt;</span><span class="s">&quot;id&quot;</span><span class="p" data-group-id="0065679452-4">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="0065679452-5">&lt;&lt;</span><span class="s">&quot;7a0ce91d0d0c5e5b51e904d1ee3266a3&quot;</span><span class="p" data-group-id="0065679452-5">&gt;&gt;</span><span class="p">,</span><span class="w">
      </span><span class="p" data-group-id="0065679452-6">&lt;&lt;</span><span class="s">&quot;key&quot;</span><span class="p" data-group-id="0065679452-6">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="0065679452-7">&lt;&lt;</span><span class="s">&quot;7a0ce91d0d0c5e5b51e904d1ee3266a3&quot;</span><span class="p" data-group-id="0065679452-7">&gt;&gt;</span><span class="p">,</span><span class="w">
      </span><span class="p" data-group-id="0065679452-8">&lt;&lt;</span><span class="s">&quot;value&quot;</span><span class="p" data-group-id="0065679452-8">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="0065679452-9">#{</span><span class="p" data-group-id="0065679452-10">&lt;&lt;</span><span class="s">&quot;rev&quot;</span><span class="p" data-group-id="0065679452-10">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="0065679452-11">&lt;&lt;</span><span class="s">&quot;15-15c0b3c4efa74f9a80d28ac040f18bdb&quot;</span><span class="p" data-group-id="0065679452-11">&gt;&gt;</span><span class="p" data-group-id="0065679452-9">}</span><span class="p">,</span><span class="w">
      </span><span class="p" data-group-id="0065679452-12">&lt;&lt;</span><span class="s">&quot;doc&quot;</span><span class="p" data-group-id="0065679452-12">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="0065679452-13">#{</span><span class="w">
        </span><span class="p" data-group-id="0065679452-14">&lt;&lt;</span><span class="s">&quot;_id&quot;</span><span class="p" data-group-id="0065679452-14">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="0065679452-15">&lt;&lt;</span><span class="s">&quot;7a0ce91d0d0c5e5b51e904d1ee3266a3&quot;</span><span class="p" data-group-id="0065679452-15">&gt;&gt;</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="0065679452-16">&lt;&lt;</span><span class="s">&quot;_rev&quot;</span><span class="p" data-group-id="0065679452-16">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="0065679452-17">&lt;&lt;</span><span class="s">&quot;15-15c0b3c4efa74f9a80d28ac040f18&quot;</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p" data-group-id="0065679452-17">&gt;&gt;</span><span class="w">
      </span><span class="p" data-group-id="0065679452-13">}</span><span class="w">
    </span><span class="p" data-group-id="0065679452-3">}</span><span class="w">
</span><span class="p" data-group-id="0065679452-2">]</span><span class="p" data-group-id="0065679452-1">}</span><span class="p">.</span></code></pre><p>All functions to manipulate these results are in the <code class="inline">couchbeam_view</code> module.</p><h3 id="couch-db-views" class="section-heading"><a href="#couch-db-views" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Couch DB views</span></h3><p>Views are workin like all_docs. You have to create a View object before
doing anything.</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="n">Options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="4086815805-1">[</span><span class="p" data-group-id="4086815805-1">]</span><span class="p">,</span><span class="w">
</span><span class="n">DesignName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;designname&quot;</span><span class="p">,</span><span class="w">
</span><span class="n">ViewName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;viewname&quot;</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="4086815805-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">ViewResults</span><span class="p" data-group-id="4086815805-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam_view</span><span class="p">:</span><span class="nf">fetch</span><span class="p" data-group-id="4086815805-3">(</span><span class="n">Db</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4086815805-4">{</span><span class="n">DesignName</span><span class="p">,</span><span class="w"> </span><span class="n">ViewName</span><span class="p" data-group-id="4086815805-4">}</span><span class="p">,</span><span class="w"> </span><span class="n">Options</span><span class="p" data-group-id="4086815805-3">)</span><span class="p">.</span></code></pre><p>Like the <code class="inline">all_docs</code> function, use the functions
from <code class="inline">couchbeam_view</code> module to manipulate results. You can pass
any querying options from the <a href="http://docs.rcouch.org/en/latest/api/ddoc/views.html">view API</a>.</p><p>Design doc are created like any documents:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="n">DesignDoc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="4247226447-1">#{</span><span class="w">
    </span><span class="p" data-group-id="4247226447-2">&lt;&lt;</span><span class="s">&quot;_id&quot;</span><span class="p" data-group-id="4247226447-2">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="4247226447-3">&lt;&lt;</span><span class="s">&quot;_design/couchbeam&quot;</span><span class="p" data-group-id="4247226447-3">&gt;&gt;</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="4247226447-4">&lt;&lt;</span><span class="s">&quot;language&quot;</span><span class="p" data-group-id="4247226447-4">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="4247226447-5">&lt;&lt;</span><span class="s">&quot;javascript&quot;</span><span class="p" data-group-id="4247226447-5">&gt;&gt;</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="4247226447-6">&lt;&lt;</span><span class="s">&quot;views&quot;</span><span class="p" data-group-id="4247226447-6">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="4247226447-7">#{</span><span class="w">
        </span><span class="p" data-group-id="4247226447-8">&lt;&lt;</span><span class="s">&quot;test&quot;</span><span class="p" data-group-id="4247226447-8">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="4247226447-9">#{</span><span class="w">
            </span><span class="p" data-group-id="4247226447-10">&lt;&lt;</span><span class="s">&quot;map&quot;</span><span class="p" data-group-id="4247226447-10">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="4247226447-11">&lt;&lt;</span><span class="s">&quot;function (doc) {\n if (doc.type == \&quot;test\&quot;) {\n emit(doc._id, doc);\n}\n}&quot;</span><span class="p" data-group-id="4247226447-11">&gt;&gt;</span><span class="w">
        </span><span class="p" data-group-id="4247226447-9">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="4247226447-12">&lt;&lt;</span><span class="s">&quot;test2&quot;</span><span class="p" data-group-id="4247226447-12">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="4247226447-13">#{</span><span class="w">
            </span><span class="p" data-group-id="4247226447-14">&lt;&lt;</span><span class="s">&quot;map&quot;</span><span class="p" data-group-id="4247226447-14">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="4247226447-15">&lt;&lt;</span><span class="s">&quot;function (doc) {\n if (doc.type == \&quot;test2\&quot;) {\n emit(doc._id, null);\n}\n}&quot;</span><span class="p" data-group-id="4247226447-15">&gt;&gt;</span><span class="w">
        </span><span class="p" data-group-id="4247226447-13">}</span><span class="w">
    </span><span class="p" data-group-id="4247226447-7">}</span><span class="w">
</span><span class="p" data-group-id="4247226447-1">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="4247226447-16">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">DesignDoc1</span><span class="p" data-group-id="4247226447-16">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam</span><span class="p">:</span><span class="nf">save_doc</span><span class="p" data-group-id="4247226447-17">(</span><span class="n">Db</span><span class="p">,</span><span class="w"> </span><span class="n">DesignDoc</span><span class="p" data-group-id="4247226447-17">)</span><span class="p">.</span></code></pre><p>You can also use <a href="http://github.com/couchapp/couchapp">couchapp</a> to manage them
more easily.</p><h3 id="stream-view-results" class="section-heading"><a href="#stream-view-results" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Stream View results</span></h3><p>While you can get results using <code class="inline">couchbeam_views:fetch/2</code>, you can also retrieve
all rows in a streaming fashion:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="n">ViewFun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="5941892345-1">(</span><span class="n">Ref</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p" data-group-id="5941892345-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">receive</span><span class="w">
        </span><span class="p" data-group-id="5941892345-2">{</span><span class="n">Ref</span><span class="p">,</span><span class="w"> </span><span class="ss">done</span><span class="p" data-group-id="5941892345-2">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="5941892345-3">(</span><span class="s">&quot;done&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5941892345-4">[</span><span class="p" data-group-id="5941892345-4">]</span><span class="p" data-group-id="5941892345-3">)</span><span class="p">,</span><span class="w">
            </span><span class="ss">done</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="5941892345-5">{</span><span class="n">Ref</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5941892345-6">{</span><span class="ss">row</span><span class="p">,</span><span class="w"> </span><span class="n">Row</span><span class="p" data-group-id="5941892345-6">}</span><span class="p" data-group-id="5941892345-5">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="5941892345-7">(</span><span class="s">&quot;got </span><span class="si">~p</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5941892345-8">[</span><span class="n">Row</span><span class="p" data-group-id="5941892345-8">]</span><span class="p" data-group-id="5941892345-7">)</span><span class="p">,</span><span class="w">
            </span><span class="n">F</span><span class="p" data-group-id="5941892345-9">(</span><span class="n">Ref</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p" data-group-id="5941892345-9">)</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="5941892345-10">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="n">Ref</span><span class="p">,</span><span class="w"> </span><span class="n">Error</span><span class="p" data-group-id="5941892345-10">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="5941892345-11">(</span><span class="s">&quot;error: </span><span class="si">~p</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5941892345-12">[</span><span class="n">Error</span><span class="p" data-group-id="5941892345-12">]</span><span class="p" data-group-id="5941892345-11">)</span><span class="w">
    </span><span class="k">end</span><span class="w">
</span><span class="k">end</span><span class="p">,</span><span class="w">

</span><span class="p" data-group-id="5941892345-13">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">StreamRef</span><span class="p" data-group-id="5941892345-13">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam_view</span><span class="p">:</span><span class="nf">stream</span><span class="p" data-group-id="5941892345-14">(</span><span class="n">Db</span><span class="p">,</span><span class="w"> </span><span class="ss">&#39;all_docs&#39;</span><span class="p" data-group-id="5941892345-14">)</span><span class="p">,</span><span class="w">
</span><span class="n">ViewFun</span><span class="p" data-group-id="5941892345-15">(</span><span class="n">StreamRef</span><span class="p">,</span><span class="w"> </span><span class="n">ViewFun</span><span class="p" data-group-id="5941892345-15">)</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="5941892345-16">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">StreamRef2</span><span class="p" data-group-id="5941892345-16">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam_view</span><span class="p">:</span><span class="nf">stream</span><span class="p" data-group-id="5941892345-17">(</span><span class="n">Db</span><span class="p">,</span><span class="w"> </span><span class="ss">&#39;all_docs&#39;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5941892345-18">[</span><span class="ss">include_docs</span><span class="p" data-group-id="5941892345-18">]</span><span class="p" data-group-id="5941892345-17">)</span><span class="p">,</span><span class="w">
</span><span class="n">ViewFun</span><span class="p" data-group-id="5941892345-19">(</span><span class="n">StreamRef2</span><span class="p">,</span><span class="w"> </span><span class="n">ViewFun</span><span class="p" data-group-id="5941892345-19">)</span><span class="p">.</span></code></pre><p>You can of course do the same with a view:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="n">DesignNam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;designname&quot;</span><span class="p">,</span><span class="w">
</span><span class="n">ViewName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;viewname&quot;</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="5523077769-1">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">StreamRef3</span><span class="p" data-group-id="5523077769-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam_view</span><span class="p">:</span><span class="nf">stream</span><span class="p" data-group-id="5523077769-2">(</span><span class="n">Db</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5523077769-3">{</span><span class="n">DesignNam</span><span class="p">,</span><span class="w"> </span><span class="n">ViewName</span><span class="p" data-group-id="5523077769-3">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5523077769-4">[</span><span class="ss">include_docs</span><span class="p" data-group-id="5523077769-4">]</span><span class="p" data-group-id="5523077769-2">)</span><span class="p">,</span><span class="w">
</span><span class="n">ViewFun</span><span class="p" data-group-id="5523077769-5">(</span><span class="n">StreamRef3</span><span class="p">,</span><span class="w"> </span><span class="n">ViewFun</span><span class="p" data-group-id="5523077769-5">)</span><span class="p">.</span></code></pre><h3 id="put-fetch-and-delete-documents-attachments" class="section-heading"><a href="#put-fetch-and-delete-documents-attachments" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Put, Fetch and Delete documents attachments</span></h3><p>You can add attachments to any documents. Attachments could be anything.</p><p>To send an attachment:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="n">DocID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;test&quot;</span><span class="p">,</span><span class="w">
</span><span class="n">AttName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;test.txt&quot;</span><span class="p">,</span><span class="w">
</span><span class="n">Att</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;some content I want to attach&quot;</span><span class="p">,</span><span class="w">
</span><span class="n">Options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="6839686039-1">[</span><span class="p" data-group-id="6839686039-1">]</span><span class="w">
</span><span class="p" data-group-id="6839686039-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="n">Result</span><span class="p" data-group-id="6839686039-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam</span><span class="p">:</span><span class="nf">put_attachment</span><span class="p" data-group-id="6839686039-3">(</span><span class="n">Db</span><span class="p">,</span><span class="w"> </span><span class="n">DocId</span><span class="p">,</span><span class="w"> </span><span class="n">AttName</span><span class="p">,</span><span class="w"> </span><span class="n">Att</span><span class="p">,</span><span class="w"> </span><span class="n">Options</span><span class="p" data-group-id="6839686039-3">)</span><span class="p">.</span></code></pre><p>All attachments are streamed to servers. <code class="inline">Att</code> could be also be an iolist
or functions, see <a href="couchbeam.html#put_attachment/5"><code class="inline">couchbeam:put_attachment/5</code></a> for more information.</p><p>To fetch an attachment:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="p" data-group-id="4018252242-1">{</span><span class="ss">ok</span><span class="w"> </span><span class="n">Att1</span><span class="p" data-group-id="4018252242-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam</span><span class="p">:</span><span class="nf">fetch_attachment</span><span class="p" data-group-id="4018252242-2">(</span><span class="n">Db</span><span class="p">,</span><span class="w"> </span><span class="n">DocId</span><span class="p">,</span><span class="w"> </span><span class="n">AttName</span><span class="p" data-group-id="4018252242-2">)</span><span class="p">.</span></code></pre><p>You can use <a href="couchbeam.html#stream_attachment/1"><code class="inline">couchbeam:stream_attachment/1</code></a> for the stream
fetch.</p><p>To delete an attachment:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="p" data-group-id="0043489085-1">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Doc4</span><span class="p" data-group-id="0043489085-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam</span><span class="p">:</span><span class="nf">open_doc</span><span class="p" data-group-id="0043489085-2">(</span><span class="n">Db</span><span class="p">,</span><span class="w"> </span><span class="n">DocID</span><span class="p" data-group-id="0043489085-2">)</span><span class="p">,</span><span class="w">
</span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam</span><span class="p">:</span><span class="nf">delete_attachment</span><span class="p" data-group-id="0043489085-3">(</span><span class="n">Db</span><span class="p">,</span><span class="w"> </span><span class="n">Doc4</span><span class="p">,</span><span class="w"> </span><span class="n">AttName</span><span class="p" data-group-id="0043489085-3">)</span><span class="p">.</span></code></pre><h3 id="changes" class="section-heading"><a href="#changes" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Changes</span></h3><p>Apache CouchDB and RCOUCH provide a means to get a list of changes made to documents in
the database. With couchbeam you can get changes using <a href="couchbeam_changes.html#follow_once/2"><code class="inline">couchbeam_changes:follow_once/2</code></a>.
This function returns all changes immediately. But you can also retrieve
all changes rows using longpolling :</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="n">Options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="0753902780-1">[</span><span class="p" data-group-id="0753902780-1">]</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="0753902780-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">LastSeq</span><span class="p">,</span><span class="w"> </span><span class="n">Rows</span><span class="p" data-group-id="0753902780-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam_changes</span><span class="p">:</span><span class="nf">follow_once</span><span class="p" data-group-id="0753902780-3">(</span><span class="n">Db</span><span class="p">,</span><span class="w"> </span><span class="n">Options</span><span class="p" data-group-id="0753902780-3">)</span><span class="p">.</span></code></pre><p>Options can be any Changes query parameters. See the <a href="http://docs.rcouch.org/en/latest/api/database/changes.html">change API</a> for more informations.</p><p>You can also get <a href="http://docs.rcouch.org/en/latest/api/database/changes.html#continuous">continuous</a>:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="n">ChangesFun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="8495759317-1">(</span><span class="n">StreamRef</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p" data-group-id="8495759317-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">receive</span><span class="w">
        </span><span class="p" data-group-id="8495759317-2">{</span><span class="n">StreamRef</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8495759317-3">{</span><span class="ss">done</span><span class="p">,</span><span class="w"> </span><span class="n">LastSeq</span><span class="p" data-group-id="8495759317-3">}</span><span class="p" data-group-id="8495759317-2">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="8495759317-4">(</span><span class="s">&quot;stopped, last seq is </span><span class="si">~p</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8495759317-5">[</span><span class="n">LastSeq</span><span class="p" data-group-id="8495759317-5">]</span><span class="p" data-group-id="8495759317-4">)</span><span class="p">,</span><span class="w">
            </span><span class="ss">ok</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="8495759317-6">{</span><span class="n">StreamRef</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8495759317-7">{</span><span class="ss">change</span><span class="p">,</span><span class="w"> </span><span class="n">Change</span><span class="p" data-group-id="8495759317-7">}</span><span class="p" data-group-id="8495759317-6">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="8495759317-8">(</span><span class="s">&quot;change row </span><span class="si">~p</span><span class="s"> </span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8495759317-9">[</span><span class="n">Change</span><span class="p" data-group-id="8495759317-9">]</span><span class="p" data-group-id="8495759317-8">)</span><span class="p">,</span><span class="w">
            </span><span class="n">F</span><span class="p" data-group-id="8495759317-10">(</span><span class="n">StreamRef</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p" data-group-id="8495759317-10">)</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="8495759317-11">{</span><span class="n">StreamRef</span><span class="p">,</span><span class="w"> </span><span class="n">Error</span><span class="p" data-group-id="8495759317-11">}</span><span class="p">-&gt;</span><span class="w">
            </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="8495759317-12">(</span><span class="s">&quot;error ? </span><span class="si">~p</span><span class="s"> </span><span class="si">~n</span><span class="s">,&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8495759317-13">[</span><span class="n">Error</span><span class="p" data-group-id="8495759317-13">]</span><span class="p" data-group-id="8495759317-12">)</span><span class="w">
    </span><span class="k">end</span><span class="w">
</span><span class="k">end</span><span class="p">,</span><span class="w">
</span><span class="n">Options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="8495759317-14">[</span><span class="ss">continuous</span><span class="p">,</span><span class="w"> </span><span class="ss">heartbeat</span><span class="p" data-group-id="8495759317-14">]</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="8495759317-15">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">StreamRef</span><span class="p" data-group-id="8495759317-15">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam_changes</span><span class="p">:</span><span class="nf">follow</span><span class="p" data-group-id="8495759317-16">(</span><span class="n">Db</span><span class="p">,</span><span class="w"> </span><span class="n">Options</span><span class="p" data-group-id="8495759317-16">)</span><span class="p">,</span><span class="w">
</span><span class="n">ChangesFun</span><span class="p" data-group-id="8495759317-17">(</span><span class="n">StreamRef</span><span class="p">,</span><span class="w"> </span><span class="n">ChangesFun</span><span class="p" data-group-id="8495759317-17">)</span><span class="p">.</span></code></pre><blockquote><p><strong>Note</strong>: a <code class="inline">gen_changes</code> behaviour exists in couchbeam that you can
use to create your own specific gen_server receiving changes. Have a
look in the
<a href="https://github.com/benoitc/couchbeam/blob/master/examples/test_gen_changes.erl">example</a>
for more info.</p></blockquote><h3 id="authentication-connections-options" class="section-heading"><a href="#authentication-connections-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Authentication/ Connections options</span></h3><p>You can authenticate to the database or Apache CouchDB or RCOUCH server by filling
options to the Option list in <a href="couchbeam.html#server_connection/4"><code class="inline">couchbeam:server_connection/4</code></a> for the
server or in <a href="couchbeam.html#create_db/3"><code class="inline">couchbeam:create_db/3</code></a>, <a href="couchbeam.html#open_db/3"><code class="inline">couchbeam:open_db/3</code></a>,
<a href="couchbeam.html#open_or_create_db/3"><code class="inline">couchbeam:open_or_create_db/3</code></a> functions.</p><p>To set basic_auth on a server:</p><pre><code class="makeup erlang" translate="no"><span class="w">   </span><span class="ss">erlang</span><span class="w">
</span><span class="n">UserName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;guest&quot;</span><span class="p">,</span><span class="w">
</span><span class="n">Password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;test&quot;</span><span class="p">,</span><span class="w">
</span><span class="n">Url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;http://localhost:5984&quot;</span><span class="p">,</span><span class="w">
</span><span class="n">Options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="0370324972-1">[</span><span class="p" data-group-id="0370324972-2">{</span><span class="ss">basic_auth</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0370324972-3">{</span><span class="n">UserName</span><span class="p">,</span><span class="w"> </span><span class="n">Password</span><span class="p" data-group-id="0370324972-3">}</span><span class="p" data-group-id="0370324972-2">}</span><span class="p" data-group-id="0370324972-1">]</span><span class="p">,</span><span class="w">
</span><span class="n">S1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">couchbeam</span><span class="p">:</span><span class="nf">server_connection</span><span class="p" data-group-id="0370324972-4">(</span><span class="n">Url</span><span class="p">,</span><span class="w"> </span><span class="n">Options</span><span class="p" data-group-id="0370324972-4">)</span><span class="p">.</span></code></pre><p>Couchbeam support SSL, OAuth, Basic Authentication, and Proxy. You can
also set a cookie. For more informations about the options have a look
in the <a href="couchbeam.html#server_connection/2"><code class="inline">couchbeam:server_connection/2</code></a> documentation.</p><h2 id="contribute" class="section-heading"><a href="#contribute" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Contribute</span></h2><p>For issues, comments or feedback please <a href="http://github.com/benoitc/couchbeam/issues">create an
issue</a>.</p>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

  </div>
  <div class="bottom-actions-item">

      <a href="news.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page â†’
        </span>
        <span class="title">
Changelog
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

          <span class="line">
            <a href="https://hex.pm/packages/couchbeam/2.0.0" class="footer-hex-package">Hex Package</a>

            <a href="https://preview.hex.pm/preview/couchbeam/2.0.0">Hex Preview</a>

              (<a href="https://preview.hex.pm/preview/couchbeam/2.0.0/show/README.md">current file</a>)

          </span>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="couchbeam.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.2) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
